<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021b"><title>A script demonstrating how to work with databases in MATLAB </title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S3 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S10 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S11 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsErrorElement .diagnosticMessage-errorType {    overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsWarningElement .diagnosticMessage-warningType {    overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2019 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: rgb(255,100,0);    text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: rgb(230,0,0);    text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 550px;}
.embeddedOutputsTextElement .textElement,.embeddedOutputsVariableStringElement .textElement {    overflow: auto;}
.textElement,.rtcDataTipElement .textElement {    padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S13 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>A script demonstrating how to work with databases in MATLAB </span></h1><div  class = 'S1'><span>This MATLAB Live Script (mlx-file) accompanies the article "Hacking Medical Physics. Part 2. Working with databasesâ€”a step beyond spreadsheets" published in the Spring 2022 issue of </span><span style=' font-style: italic;'>European Medical Physics News</span><span>. The script illustrates how to:</span></div><ul  class = 'S2'><li  class = 'S3'><span>Connect to an SQLite database in MATLAB using the JDBC drivers (the driver is in the </span><span style=' font-style: italic;'>lib-matlab</span><span> subdirectory of this repository, i.e. </span><span style=' font-style: italic;'>EMP-News/Part2/lib-matlab</span><span>)</span></li><li  class = 'S3'><span>How to read Excel file data with a fictionalized style of staff dose report into MATLAB.</span></li><li  class = 'S3'><span>How to write the staff dose data to an SQLite database</span></li><li  class = 'S3'><span>How to query the database</span></li><li  class = 'S3'><span>And how to process and plot the query results in boxplots </span></li></ul><div  class = 'S1'><span>Requirements: this script requires that the </span><span style=' font-style: italic;'>Database Toolbox</span><span> of MATLAB is installed, along with the </span><span style=' font-style: italic;'>Statistics and Machine Learning Toolbox </span><span>(the latter only for creating the boxplots).</span></div><div  class = 'S1'><span>We will clear the MATLAB workspace before beginning.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >clear</span></span></div></div></div><h2  class = 'S5'><span>1. Define SQLite data fields and checks</span></h2><div  class = 'S1'><span>We start by defining three MATLAB variables: </span><span style=' font-family: monospace;'>fileFields</span><span>, </span><span style=' font-family: monospace;'>addFields</span><span> and </span><span style=' font-family: monospace;'>check</span><span>.</span></div><div  class = 'S1'><span style=' font-family: monospace;'>fileFields</span><span>: this is a cell array, with each element corresponding to a column of the dose report (i.e., Excel) files we intend to read. Each cell element itself consists or two character arrays: the name of the data column and the type it will be saved as in the SQLite database. Note that the column name need not match the name in the Excel file, although the order in the cell array matches the column order in the Excel file.</span></div><div  class = 'S1'><span style=' font-family: monospace;'>addFields</span><span>: this is a cell array listing any additional fields that we wish to save to the SQLite database. In this case, it will be only one field: a status variable indicating whether a dose reading was valid ('OK'), below threshold ('B') or not returned ('NR').</span></div><div  class = 'S1'><span style=' font-family: monospace;'>check</span><span>: this is a character array defining a check statement to be passed to SQLite. When part of the definition of an SQLite data table, it enforces the listed conditions when data entries are added to the database, i.e., an error is thrown by SQLite if the conditions are not met. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >fileFields = { {</span><span style="color: rgb(170, 4, 249);">'Customer'</span><span >, </span><span style="color: rgb(170, 4, 249);">'VARCHAR'</span><span >}, {</span><span style="color: rgb(170, 4, 249);">'CustomerUID'</span><span >, </span><span style="color: rgb(170, 4, 249);">'INTEGER'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >     {</span><span style="color: rgb(170, 4, 249);">'Department'</span><span >, </span><span style="color: rgb(170, 4, 249);">'VARCHAR'</span><span >}, {</span><span style="color: rgb(170, 4, 249);">'DepartmentUID'</span><span >, </span><span style="color: rgb(170, 4, 249);">'INTEGER'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >     {</span><span style="color: rgb(170, 4, 249);">'Name'</span><span >, </span><span style="color: rgb(170, 4, 249);">'VARCHAR'</span><span >}, {</span><span style="color: rgb(170, 4, 249);">'PersonUID'</span><span >, </span><span style="color: rgb(170, 4, 249);">'INTEGER'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >     {</span><span style="color: rgb(170, 4, 249);">'RadiationType'</span><span >, </span><span style="color: rgb(170, 4, 249);">'VARCHAR'</span><span >}, {</span><span style="color: rgb(170, 4, 249);">'Hp10'</span><span >, </span><span style="color: rgb(170, 4, 249);">'DOUBLE'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >     {</span><span style="color: rgb(170, 4, 249);">'Hp007'</span><span >, </span><span style="color: rgb(170, 4, 249);">'DOUBLE'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >     {</span><span style="color: rgb(170, 4, 249);">'UserType'</span><span >, </span><span style="color: rgb(170, 4, 249);">'VARCHAR'</span><span >}, {</span><span style="color: rgb(170, 4, 249);">'DosimeterType'</span><span >, </span><span style="color: rgb(170, 4, 249);">'VARCHAR'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >     {</span><span style="color: rgb(170, 4, 249);">'DosimeterPlacement'</span><span >, </span><span style="color: rgb(170, 4, 249);">'VARCHAR'</span><span >}, {</span><span style="color: rgb(170, 4, 249);">'DosimeterUID'</span><span >, </span><span style="color: rgb(170, 4, 249);">'INTEGER'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >     {</span><span style="color: rgb(170, 4, 249);">'StartDate'</span><span >, </span><span style="color: rgb(170, 4, 249);">'DATE'</span><span >}, {</span><span style="color: rgb(170, 4, 249);">'EndDate'</span><span >, </span><span style="color: rgb(170, 4, 249);">'DATE'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >     {</span><span style="color: rgb(170, 4, 249);">'ReadDate'</span><span >, </span><span style="color: rgb(170, 4, 249);">'DATE'</span><span >}, {</span><span style="color: rgb(170, 4, 249);">'ReportDate'</span><span >, </span><span style="color: rgb(170, 4, 249);">'DATE'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >     {</span><span style="color: rgb(170, 4, 249);">'ReportUID'</span><span >, </span><span style="color: rgb(170, 4, 249);">'INTEGER'</span><span >}};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >addFields = {{</span><span style="color: rgb(170, 4, 249);">'Status'</span><span >, </span><span style="color: rgb(170, 4, 249);">'VARCHAR'</span><span >}};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >check = [</span><span style="color: rgb(170, 4, 249);">'CHECK( (Status IN (''NR'',''B'') AND ' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'(Hp10 IS NULL AND Hp007 IS NULL)) OR ' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'(Status IN (''OK'') AND '</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'(Hp10 IS NOT NULL OR Hp007 IS NOT NULL))) '</span><span >];</span></span></div></div></div><div  class = 'S9'><span>    </span><span style=' font-weight: bold; font-style: italic;'>An aside on character arrays and strings (not essential, but may be helpful)</span></div><div  class = 'S1'><span>The differences between </span><span style=' font-style: italic;'>character arrays</span><span> and </span><span style=' font-style: italic;'>string arrays</span><span> can be slightly confusing in MATLAB. Check the MATLAB Help for more information. It's worth noting, however, that in MATLAB character arrays are defined between single quotes, whereas strings are defined between double quotes. To include a single quote character within a character array, one simply writes two single quotes together. Thus, the check statement above will actually display as:</span></div><div  class = 'S1'><span>check =</span></div><div  class = 'S1'><span>    'CHECK( (Status IN ('NR','B') AND (Hp10 IS NULL AND Hp007 IS NULL)) OR (Status IN ('OK') AND (Hp10 IS NOT NULL OR Hp007 IS NOT NULL))) '</span></div><div  class = 'S1'><span>In this script, some text sequences are stored in variables as strings and others as character arrays. We have tried to be consistent to the extent that all explicitly written (hard-coded) text sequences are written as character arrays. When working with string variables, we some sometimes rely on implicit conversion of character arrays to strings. For example, in Section 5 we pass character arrays to the </span><span style=' font-family: monospace;'>contains()</span><span> function as the substrings for matching. MATLAB is clever enough to interpret our inputs correctly. It's important to remember, however, that some statements that you can execute with strings are invalid with character arrays and </span><span style=' font-style: italic;'>vice versa</span><span>. After all, there are reasons why both data types exist!</span></div><h2  class = 'S5'><span>2. Setup and configure SQLite database (if it doesn't exist)</span></h2><div  class = 'S1'><span>First, we define a path name for the directory for our database file to be placed in. The directory is to be called 'db-matlab' and will be placed in a present working directory (which is returned by the </span><span style=' font-family: monospace;'>pwd</span><span> function). If the database directory dosesn't already exist then it is made using the make directory function, </span><span style=' font-family: monospace;'>mkdir()</span><span>. Note that </span><span style=' font-family: monospace;'>fullfile()</span><span> function adds the directory name ('db-matlab') to the path (</span><span style=' font-family: monospace;'>pwd</span><span>) with the appropriate slash separator inserted between them. The full path to the database file is then generated and assigned to the variable </span><span style=' font-family: monospace;'>dbFile</span><span>, again using </span><span style=' font-family: monospace;'>fullfile()</span><span> function.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >databasePath = fullfile(pwd,</span><span style="color: rgb(170, 4, 249);">'db-matlab'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >~exist(databasePath, </span><span style="color: rgb(170, 4, 249);">'dir'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    mkdir(databasePath);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >dbFile = fullfile(databasePath,</span><span style="color: rgb(170, 4, 249);">'dose-matlab.db'</span><span >);</span></span></div></div></div><div  class = 'S9'><span>Now we check if our database source exists (it won't unless you've run this script previously). The </span><span style=' font-family: monospace;'>listDataSources()</span><span> function returns a MATLAB table with details of data sources. The next line checks whether the 'Name' column in the table has any entries equal to </span><span style=' font-family: monospace;'>ourSource</span><span> (i.e.,  "SQLiteEMP"). If so, the </span><span style=' font-family: monospace;'>createDataSource</span><span> variable takes the value </span><span style=' font-family: monospace;'>false</span><span>, otherwise it takes the value </span><span style=' font-family: monospace;'>true</span><span>. If </span><span style=' font-family: monospace;'>true</span><span>, the if-statement is executed and the datasource SQLiteEMP is created, with the path to the JDBC driver file specified. Note that the database file name associated with this source is defined to be 'dose-matlab.db' and its location defined as the directory created earlier (i.e., </span><span style=' font-family: monospace;'>databasePath</span><span>).</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ourSource = </span><span style="color: rgb(170, 4, 249);">'SQLiteEMP'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >dataSources = listDataSources();</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >createDataSource = (sum(dataSources.(</span><span style="color: rgb(170, 4, 249);">'Name'</span><span >) == ourSource) == 0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >createDataSource</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    vendor = </span><span style="color: rgb(170, 4, 249);">'Other'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    opts = databaseConnectionOptions(</span><span style="color: rgb(170, 4, 249);">'jdbc'</span><span >,vendor);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    opts = setoptions(opts, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'DataSourceName'</span><span >,ourSource, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'JDBCDriverLocation'</span><span >,</span><span style="color: rgb(170, 4, 249);">'lib-matlab/sqlite-jdbc-3.36.0.3.jar'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'Driver'</span><span >,</span><span style="color: rgb(170, 4, 249);">'org.sqlite.JDBC'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span><span style="color: rgb(2, 128, 9);">  </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'URL'</span><span >,strcat(</span><span style="color: rgb(170, 4, 249);">'jdbc:sqlite:'</span><span >,dbFile));</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    saveAsDataSource(opts);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span>We've made sure that the directory to hold the database exists and that an appropriate database source is configured in MATLAB. Now, if the database file itself doesn't exist (which it won't if you have never run this script), it will be created. This is done by connecting to the data source using the </span><span style=' font-family: monospace;'>database()</span><span> function. An SQL data table called 'doseTable' is also added to the SQLite database using the </span><span style=' font-family: monospace;'>execute()</span><span> function. The character array </span><span style=' font-family: monospace;'>createTable</span><span> is passed to </span><span style=' font-family: monospace;'>execute()</span><span>, defining the data columns and types of the SQLite table, as well as the data checks. Refer to the</span><span style=' font-family: monospace;'> getCreateTable()</span><span> function at the bottom of the script to see how we generate the character array. The connection to the database is closed using the the </span><span style=' font-family: monospace;'>close()</span><span> function.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >~isfile(dbFile)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    conn = database(ourSource,</span><span style="color: rgb(170, 4, 249);">''</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >); </span><span style="color: rgb(2, 128, 9);">% Connect to the database</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    createTable = getCreateTable(</span><span style="color: rgb(170, 4, 249);">'doseTable'</span><span >,fileFields,addFields,check); </span><span style="color: rgb(2, 128, 9);">% Define and sql statement to create table</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    execute(conn,createTable)  </span><span style="color: rgb(2, 128, 9);">% Create the sql table in the database</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    close(conn); </span><span style="color: rgb(2, 128, 9);">% Close the database connection</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S5'><span>3. Read data from Excel files and write to the database</span></h2><div  class = 'S1'><span>We provide a pop-up window to the user to specifiy the location of the Excel files. This is done using the </span><span style=' font-family: monospace;'>uigetdir()</span><span> function. The user should select the </span><span style=' font-style: italic;'>reports</span><span> directory when running the example, as we have populated this with example files. The </span><span style=' font-family: monospace;'>dir()</span><span> function is then used to return a table of file details for all files in the directory that have the file suffix 'xls'.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >newDataLocation = uigetdir(pwd,</span><span style="color: rgb(170, 4, 249);">'Select a directory with dose reports'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >files = dir(fullfile(newDataLocation,</span><span style="color: rgb(170, 4, 249);">'*xls'</span><span >));</span></span></div></div></div><div  class = 'S9'><span>A connection to the data source is opened and then the set of Excel files are iterated through. See the function </span><span style=' font-family: monospace;'>getDataFromExcel()</span><span> at the bottom of this script to see how we extract the data from the Excel files. Before writing to the database, a check is performed to see if the data has previously been written to the database. This is achived using the </span><span style=' font-family: monospace;'>getIsNew()</span><span> function (again see the bottom of the script for the function definition), which checks to see whether the value of the 'ReportUID' field already exists in the database. If the data does already existsin the database, the file is skipped by using a </span><span style=' font-family: monospace;'>continue</span><span> statement, which jumps to the next value of the incrementer in the for-loop. If the data is new, the rows of the Excel files (dosimeter readings) are iterated through, with each row being written to the database table using the </span><span style=' font-family: monospace;'>insert()</span><span> function. The </span><span style=' font-family: monospace;'>getRowData()</span><span> function (see end of script) formats the row data and column names in a format appropriate for the interface to SQLite. When all the data has been written, the database connection is closed.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >conn = database(ourSource,</span><span style="color: rgb(170, 4, 249);">''</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >nf = numel(files);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:nf </span><span style="color: rgb(2, 128, 9);">% Iterate through the Excel files</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    fpop = msgbox([</span><span style="color: rgb(170, 4, 249);">'Processing file ' </span><span >num2str(i) </span><span style="color: rgb(170, 4, 249);">' of ' </span><span >num2str(nf)],</span><span style="color: rgb(170, 4, 249);">'modal'</span><span >); </span><span style="color: rgb(2, 128, 9);">% Pop-up to indicate progress</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    doseData = getDataFromExcel(files(i),fileFields);  </span><span style="color: rgb(2, 128, 9);">% See functions at end of script</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    isNew = getIsNew(doseData,conn,</span><span style="color: rgb(170, 4, 249);">'ReportUID'</span><span >,true); </span><span style="color: rgb(2, 128, 9);">% See functions at end of script</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >~isNew</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        disp(</span><span style="color: rgb(170, 4, 249);">'Ignoring a file based on non-unique ReportNr'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        disp([files(i).name </span><span style="color: rgb(170, 4, 249);">' is already in the database'</span><span >]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">continue</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    nl = size(doseData,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">for </span><span >j=1:nl </span><span style="color: rgb(2, 128, 9);">% Iterate through rows of an Excel file (dosimeter readings)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        [rowData, colNames] = getRowData(fileFields,addFields,doseData(j,:)); </span><span style="color: rgb(2, 128, 9);">% See functions at end of script</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        insert(conn,</span><span style="color: rgb(170, 4, 249);">'doseTable'</span><span >,colNames,rowData) </span><span style="color: rgb(2, 128, 9);">% Insert data into the database</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >ishandle(fpop)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    close(fpop)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >close(conn);</span></span></div></div></div><h2  class = 'S5'><span>4. Querying the database</span></h2><div  class = 'S1'><span>In practice, queries would likely be performed in the MATLAB command window, or a separate script (or even using MATLAB's Database Explorer app). For illustrative purposes, however, we provide examples of querying (and plotting) here. The steps are:</span></div><ol  class = 'S2'><li  class = 'S3'><span>Connect to the database (using </span><span style=' font-family: monospace;'>database()</span><span>)</span></li><li  class = 'S3'><span>Construct a query statement (a character array)</span></li><li  class = 'S3'><span>Request the query results (using f</span><span style=' font-family: monospace;'>etch()</span><span>)</span></li><li  class = 'S3'><span>Close the connection (using </span><span style=' font-family: monospace;'>close()</span><span>)</span></li></ol><div  class = 'S1'><span>We construct a query requesting the </span><span style=' font-style: italic;'>PersonUID</span><span>, </span><span style=' font-style: italic;'>Department</span><span>, </span><span style=' font-style: italic;'>Hp10</span><span> values and measurement period </span><span style=' font-style: italic;'>EndDate</span><span> from the </span><span style=' font-style: italic;'>doseTable</span><span> table of the SQLite database, for data entries where the dosimeter is of type 'Badge' and the reading status is valid (i.e., 'OK'). The data extracted is also ordered by increasing value of </span><span style=' font-style: italic;'>EndDate</span><span>, using the "ORDER BY" clause of SQLite. The data is returned as a MATLAB table with the variable name of </span><span style=' font-family: monospace;'>results</span><span>. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >conn = database(</span><span style="color: rgb(170, 4, 249);">'SQLiteEMP'</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >sqlQuery = [</span><span style="color: rgb(170, 4, 249);">'SELECT PersonUID, Department, Hp10, EndDate FROM doseTable ' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'WHERE DosimeterType = ''Badge'' AND Status IN (''OK'') ' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'ORDER BY EndDate'</span><span >];</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >results = fetch(conn,sqlQuery);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >close(conn);</span></span></div></div></div><div  class = 'S9'><span>Note that we have not included dosimeter results below minimum threshold in the returned results (i.e., Status = 'B'). Although a user might wish to include these cases in practice, a decision on the numerical value of dose to assign to them would have to be made.  </span></div><h2  class = 'S10'><span>5. Processing the results and plotting the data</span></h2><div  class = 'S1'><span>Now we will filter the results and plot them in boxplots, breaking the Hp(10) dose readings down by department and year. A straightforward way to do this is to create masks (arrays of </span><span style=' font-family: monospace;'>true</span><span> and </span><span style=' font-family: monospace;'>false</span><span> values) that select the year or department. This is done below. The </span><span style=' font-family: monospace;'>contains()</span><span> function is useful for testing whether a substring is present within a string (or within each string of a string array, as we do here).</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >EndDates = string(results.EndDate);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >mask2020 = contains(EndDates,</span><span style="color: rgb(170, 4, 249);">'2020'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >mask2021 = contains(EndDates,</span><span style="color: rgb(170, 4, 249);">'2021'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >Departments = string(results.Department);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >maskNM=contains(Departments,</span><span style="color: rgb(170, 4, 249);">'Nuclear Medicine'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >maskDR=contains(Departments,</span><span style="color: rgb(170, 4, 249);">'Diagnostic Radiology'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >maskRT=contains(Departments,</span><span style="color: rgb(170, 4, 249);">'Radiotherapy'</span><span >);</span></span></div></div></div><div  class = 'S9'><span>Now we generate a figure and create the first subplot, corresponding to the Nuclear Medicine department and the years 2020 and 2021. The year and department masks are used to filter the results. The </span><span style=' font-family: monospace;'>boxplot()</span><span> function of MATLAB is then used to display the data,. The </span><span style=' font-family: monospace;'>ylim()</span><span> (the y-axis extent), </span><span style=' font-family: monospace;'>ylabel()</span><span> (the label for the y-axis) and </span><span style=' font-family: monospace;'>xlabel</span><span> (the label for the x-axis) functions are used to format the plot.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >subplot(1,3,1) </span><span style="color: rgb(2, 128, 9);">% Nuclear Medicine subplot</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >doses2020 = results(mask2020 &amp; maskNM,:).(</span><span style="color: rgb(170, 4, 249);">'Hp10'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >num2020 = numel(doses2020);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2020 = strings(num2020,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2020(1:num2020) = </span><span style="color: rgb(170, 4, 249);">'2020'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >doses2021 = results(mask2021 &amp; maskNM,:).(</span><span style="color: rgb(170, 4, 249);">'Hp10'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >num2021 = numel(doses2021);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2021 = strings(num2021,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2021(1:num2021) = </span><span style="color: rgb(170, 4, 249);">'2021'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >boxplot([doses2020;doses2021],[years2020;years2021],</span><span style="color: rgb(170, 4, 249);">'symbol'</span><span >,</span><span style="color: rgb(170, 4, 249);">'r.'</span><span >, </span><span style="color: rgb(170, 4, 249);">'OutlierSize'</span><span >,10)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ylim([0.04,0.205])</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(170, 4, 249);">'Hp(10)'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(170, 4, 249);">'Nuclear Medicine'</span><span >)</span></span></div></div></div><div  class = 'S9'><span>We then repeat the same process for the Diagnostic Radiology and Radiotherapy departments.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >subplot(1,3,2) </span><span style="color: rgb(2, 128, 9);">% Diagnostic Radiology subplot</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >doses2020 = results(mask2020 &amp; maskDR,:).(</span><span style="color: rgb(170, 4, 249);">'Hp10'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >num2020 = numel(doses2020);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2020 = strings(num2020,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2020(1:num2020) = </span><span style="color: rgb(170, 4, 249);">'2020'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >doses2021 = results(mask2021 &amp; maskDR,:).(</span><span style="color: rgb(170, 4, 249);">'Hp10'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >num2021 = numel(doses2021);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2021 = strings(num2021,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2021(1:num2021) = </span><span style="color: rgb(170, 4, 249);">'2021'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >boxplot([doses2020;doses2021],[years2020;years2021],</span><span style="color: rgb(170, 4, 249);">'symbol'</span><span >,</span><span style="color: rgb(170, 4, 249);">'r.'</span><span >, </span><span style="color: rgb(170, 4, 249);">'OutlierSize'</span><span >,10)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ylim([0.04,0.205])</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(170, 4, 249);">'Diagnostic Radiology'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >subplot(1,3,3) </span><span style="color: rgb(2, 128, 9);">% Radiotherapy subplot</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >doses2020 = results(mask2020 &amp; maskRT,:).(</span><span style="color: rgb(170, 4, 249);">'Hp10'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >num2020 = numel(doses2020);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2020 = strings(num2020,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2020(1:num2020) = </span><span style="color: rgb(170, 4, 249);">'2020'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >doses2021 = results(mask2021 &amp; maskRT,:).(</span><span style="color: rgb(170, 4, 249);">'Hp10'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >num2021 = numel(doses2021);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2021 = strings(num2021,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >years2021(1:num2021) = </span><span style="color: rgb(170, 4, 249);">'2021'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >boxplot([doses2020;doses2021],[years2020;years2021],</span><span style="color: rgb(170, 4, 249);">'symbol'</span><span >,</span><span style="color: rgb(170, 4, 249);">'r.'</span><span >, </span><span style="color: rgb(170, 4, 249);">'OutlierSize'</span><span >,10)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ylim([0.04,0.205])</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(170, 4, 249);">'Radiotherapy'</span><span >)</span></span></div><div  class = 'S12'><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjAAAAGkCAYAAAAv7h+nAAAgAElEQVR4AezBf2jch33/8ac+tgm9uVn9Rxurk4hjNN6lqXEkPOSmhpPc+6MLGyahi2OYqVSTJXJ1gQRWkHX49BFRz5zbhkotByXjlK2z4/5jSnACivGdiCt8qrjMeBl7T0JWp3KyWJGDIKZuko++1R8CfV0piX/E8imvxyNYEBEREakyASIiIiJVJkBERESkygSIiIiIVJkAERERkSoTICIiIlJlAkRERESqTICIiIhIlQkQERERqTIBIiIiIlUmQERERKTKBIiIiIhUmQARERGRKhMgIiIiUmUCRERERKpMgIiIiEiVCRARERGpMgEiIiIiVSZAREREpMoEiIiIiFSZABEREZEqEyAiIiJSZQJEREREqkyAiIiISJUJEBEREakyASIiIiJVJkBERESkygSIiIiIVJkAERERkSoTICIiIlJlAkRERESqTICIiIhIlQmQj3Xw4EHMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8yMgwcPcq86ePAgZoaZYWaYGWaGmWFmmBlmhplhZpgZZoaZYWaYGWaGmWFmmBlmhplhZpgZZoaZYWaYGWaGmWFmmBlmhplhZpgZZoaZYWaYGWaGmWFmmBlmhplhZpgZZoaZYWaYGWaGmWFmmBlmhplhZpgZZoaZYWaYGWaGmWFmmBlmhplhZpgZZoaZYWaYGWaGmWFmmBlmhplhZpgZZoaZYWaYGWaGmWFmmBlmhplhZpgZZoaZYWaYGWaGmWFmmBlmhplhZpgZZoaZYWaYGWaGmWFmmBlmhplx8OBB7kUHDx7EzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDPMDDPDzDAzzAwzw8wwM8wMM8PMMDMOHjzIehQgH2t0dBR3x91xd9wdd8fdcXfcHXfH3XF33B13x91xd9wdd8fdcXfcHXfH3XF33B13x91xd9ydRe6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o674+4scnfcHXfH3XF33B13x91xd9wdd8fdcXfcHXfH3XF33B13x91xd9wdd8fdcXfcHXfH3RkdHeVeNTo6irvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o67s8jdcXfcHXfH3XF33B13x91xd9wdd8fdcXfcHXfH3XF33B13x91xd9wdd8fdcXfcHXfH3XF33B13x91xd9wdd8fdcXfcHXfH3XF33B13x91xd9wdd8fdcXfcHXfH3XF33B13x91xd9ydRe6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDujo6Pci0ZHR3F33B13x91xd9wdd8fdcXfcHXfH3XF33B13x91xd9wdd8fdcXfcHXfH3XF33B13x91xdxa5O+6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o674+64O+6Ou+PuuDvujrvj7rg77o67s8jdcXfcHXfH3XF33B13x91xd9wdd8fdcXfcHXfH3XF33B13x91xd9wdd8fdcXfcHXdndHSU9ShAREREpMoEyD2ps7OTz5LOzk5k7XV2dvJZ0tnZiaytzs5OPks6OzuROyNA7knJZJLPkmQyiay9ZDLJZ0kymUTWVjKZ5LMkmUwid0bAOhVFEZVKhSiK+DjXr19nbm4OkdsRRRGVSoUoivg4169fZ25uDpHbEUURlUqFKIr4ONevX2dubg6R9SJg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Grk1ASIiIiJVJkBERGQNpNNp0uk0IrciQO5Jra2tFItFRERE5M8FiIiIiFSZABEREZEqEyAiIiJSZQJERP4knU6TTqcRkU9HOp0mnU4jd0aAiIjIGgjDkDAMEbkVASIiIiJVJkBERESkygSIiIiIVJkAERERkSoTIPekQqFAS0sLIndLGIaEYYiIfDrCMCQMQ+TOCBARERGpMgFVKooiKpUKURRxu65du8a7776LyEeJoohKpUIURdyua9eu8e677yLyUaIoolKpEEURt+vatWu8++67iKwXAVVobGyMRCLBsWPHSCQSlMtlVpPL5YjH45gZIyMjLDc/P8+hQ4fYv38/zz//PM899xwiKxkbGyORSHDs2DESiQTlcpnV5HI54vE4ZsbIyAjLzc/Pc+jQIfbv38/zzz/Pc889h8hKxsbGSCQSHDt2jEQiQblcZjW5XI54PI6ZMTIywnLz8/McOnSI/fv38/zzz/Pcc88hsh4EVKFUKkU2m6W/v59MJkMqlWI1e/bs4cyZM2zZsoUb9fX10djYyGuvvUY+n6e/vx+RlaRSKbLZLP39/WQyGVKpFKvZs2cPZ86cYcuWLdyor6+PxsZGXnvtNfL5PP39/YisJJVKkc1m6e/vJ5PJkEqlWM2ePXs4c+YMW7Zs4UZ9fX00Njby2muvkc/n6e/vR2Q9CKgy09PTXLlyhV27drGoubmZSqXCzMwMK9mxYwebN2/mRu+//z6vv/463/3ud3nrrbdwd0RWMj09zZUrV9i1axeLmpubqVQqzMzMsJIdO3awefNmbvT+++/z+uuv893vfpe33noLd0dkJdPT01y5coVdu3axqLm5mUqlwszMDCvZsWMHmzdv5kbvv/8+r7/+Ot/97nd56623cHfuJel0mnQ6jcitCKgyk5OTmBnLmRkTExPcjIsXL7Jp0yba29t54403+P73v8/Ro0e5V7S2tlIsFlmPpqamKBaLFItFisUixWKRYrFIsVikWCxSLBaZmpriXjE5OYmZsZyZMTExwc24ePEimzZtor29nTfeeIPvf//7HD16FLk7pqamKBaLFItFisUixWKRYrFIsVikWCxSLBaZmpriXjA5OYmZsZyZMTExwc24ePEimzZtor29nTfeeIPvf//7HD16FJH1IGAdiKKIm/XHP/6R9957jyNHjvCDH/yAX/7yl7zxxhuMj4+z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FLBGPvjgA774xS+ymvvvv5/3338fERERkRsFrJHW1lb279/PzMwMH374IUt+//vf09vbSxRFbN68GREREZEbBayR48eP09TUxLe+9S2++tWv8tWvfhUz4xvf+Ab//d//za9//WtE5O5Jp9Ok02lE5NORTqdJp9PInRGwhlKpFBcvXuQ3v/kNw8PDlEol3J0TJ04gIiIispqAe8D999/PF7/4Rb7whS8gIiIi8nEC7lH/+I//iIiIiMhKAu5R5XIZERERkZUErJHnnnuOJ554gieeeIInnniCJ554gieeeIInnniCJ554AvnsaGlpoVAoICIi8kkFrJH//M//ZNOmTWzatIlNmzaxadMmNm3axKZNm9i0aRMicneFYUgYhojIpyMMQ8IwRO6MgDViZnzjG9/g1KlTnDp1ilOnTnHq1ClOnTrFqVOnEBEREVlNwBp54YUX+J//+R9W8zd/8zeIiIiIrCRgjfz1X/81P/3pT1nNK6+8goiIiMhKAkRERESqTMAauHbtGr/61a/4OHNzc7z44ousJIoiKpUKURRxO65fv87c3ByydorFIq2trdzroiiiUqkQRRG34/r168zNzSHycaIoolKpEEURt+P69evMzc0hsp4ErIFYLMZ//dd/sXPnTg4dOsTExASzs7P8/ve/p1Kp8C//8i+0trby93//9xw8eJAbjY2NkUgkOHbsGIlEgnK5zGpyuRzxeBwzY2RkhCXXr1/nscce46mnnqKzs5N4PM4777yDyErGxsZIJBIcO3aMRCJBuVxmNblcjng8jpkxMjLCkuvXr/PYY4/x1FNP0dnZSTwe55133kFkJWNjYyQSCY4dO0YikaBcLrOaXC5HPB7HzBgZGWHJ9evXeeyxx3jqqafo7OwkHo/zzjvvILIeBKyRrq4uLly4wO7du/mnf/on/vZv/5ZvfvOb7Nu3j0KhwL//+7/z61//mgcffJAbpVIpstks/f39ZDIZUqkUq9mzZw9nzpxhy5YtLLdx40ZyuRynT5/mxIkTHDp0iGw2i8hKUqkU2WyW/v5+MpkMqVSK1ezZs4czZ86wZcsWltu4cSO5XI7Tp09z4sQJDh06RDabRWQlqVSKbDZLf38/mUyGVCrFavbs2cOZM2fYsmULy23cuJFcLsfp06c5ceIEhw4dIpvNIrIeBKyhz33uczz99NOcO3eOcrnMxYsX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02g0qNVqVCoVbqdSqVCv12k0GtRqNSqVCgdtbW3x1ltv8aUvfYkHzcWLF3mYXLx4kQdVpVKhXq/TaDSo1WpUKhVup1KpUK/XaTQa1Go1KpUKB21tbfHWW2/xpS99iQfNxYsXeZhcvHgR8+lwjJitrS12dnaYmZlhaHZ2lsFgwPb2NodtbW2xs7PDzMwMQ7OzswwGA7a3t9l34cIFoijCmNvZ2tpiZ2eHmZkZhmZnZxkMBmxvb3PY1tYWOzs7zMzMMDQ7O8tgMGB7e5t9Fy5cIIoijLmdra0tdnZ2mJmZYWh2dpbBYMD29jaHbW1tsbOzw8zMDEOzs7MMBgO2t7fZd+HCBaIowpjjxDFiNjc3EREOEhE2NjY4bHNzExHhIBFhY2ODocuXL/PNb36TyclJPszjjz+OiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgiwpCIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIQyKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAiPP/44d2NzcxMR4SARYWNjg8M2NzcREQ4SETY2Nhi6fPky3/zmN5mcnOTDPP7444gIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICEMigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiDIkIIoKIICKICCKCiCAiiAgigoggIogIIoKIICKICCKCiCAiiAgigoggIogIIoKIICI8/vjj3Mnm5iYiwkEiwsbGBodtbm4iIhwkImxsbDB0+fJlvvnNbzI5OcmHefzxxxERRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEYZEBBFBRBARRAQRQUQQEUQEEUFEEBFEBBFBRBARRAQRQUQQEUQE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" style="height: auto;"></div></div></div><h2  class = 'S5'><span>6. Bonus queries</span></h2><div  class = 'S1'><span>We have our boxplot and are finished. This gives just a taste of what is possible when working with databases. For fun, we have included a few more example queries below.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >conn = database(</span><span style="color: rgb(170, 4, 249);">'SQLiteEMP'</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% The ORDER BY clause in SQL is useful for ordering data</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% Ordering can be ascending (ASC) or descending (DESC)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >sqlQuery = [</span><span style="color: rgb(170, 4, 249);">'SELECT StartDate, EndDate FROM doseTable ' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'WHERE Status != ''NR'' ORDER BY StartDate ASC'</span><span >];</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >results = fetch(conn,sqlQuery);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >close(conn);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >formatSpec = </span><span style="color: rgb(170, 4, 249);">'Earliest and latest records of staff dose readings are %s and %s'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >R1 = string(results{1,1});</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >R2 = string(results{end,1});</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fprintf() is useful for inserting variable values into a string before</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   printing the string to the MATLAB screen</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre"><span >fprintf(formatSpec,R1,R2)</span></span></div><div  class = 'S12'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="9E8DFE49" data-scroll-top="null" data-scroll-left="null" data-testid="output_1" style="width: 1012px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement eoOutputContent" data-width="982" data-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Earliest and latest records of staff dose readings are 2019-11-22 and 2021-12-28</div></div></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >conn = database(</span><span style="color: rgb(170, 4, 249);">'SQLiteEMP'</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% The COUNT function in SQL allow you to sum cases</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% The AS clause in SQL allows you to designate a column name for the output of a function</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% The GROUP BY clause allows you to break down the results by a variable</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >sqlQuery = [</span><span style="color: rgb(170, 4, 249);">'SELECT COUNT(Hp10) AS Nr_Hp10, COUNT(Hp007) AS Nr_Hp007, DosimeterType ' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'FROM doseTable WHERE Status != ''NR'' GROUP BY DosimeterType'</span><span >];</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >results = fetch(conn,sqlQuery);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >close(conn);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">'Number of staff dose readings, per dosimeter type:\n\n'</span><span >), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre"><span >    disp(results) </span><span style="color: rgb(2, 128, 9);">% Note: disp() allows you to print a non-text variable to screen </span></span></div><div  class = 'S12'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="297237C8" data-testid="output_2" style="width: 1012px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement eoOutputContent" data-width="982" data-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Number of staff dose readings, per dosimeter type:</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="AE865116" data-scroll-top="null" data-scroll-left="null" data-testid="output_3" style="width: 1012px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement eoOutputContent" data-width="982" data-height="73" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">    <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Nr_Hp10</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Nr_Hp007</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">DosimeterType</strong>
    <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">_______</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">________</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">_____________</strong>

      403        403         {'Badge'}  
        0         47         {'Ring' }  </div></div></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >conn = database(</span><span style="color: rgb(170, 4, 249);">'SQLiteEMP'</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >,</span><span style="color: rgb(170, 4, 249);">''</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >sqlQuery = [</span><span style="color: rgb(170, 4, 249);">'SELECT Name, COUNT(Status == "NR") AS Instances FROM doseTable ' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'WHERE Status == ''NR'' GROUP BY NAME ORDER BY COUNT(Status = ''NR'') DESC'</span><span >];</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >results = fetch(conn,sqlQuery);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >close(conn);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">'Individuals who did not return a dosimeter and number of instances:\n\n'</span><span >), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre"><span >    disp(results)</span></span></div><div  class = 'S12'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="8C54DEAE" data-testid="output_4" style="width: 1012px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement eoOutputContent" data-width="982" data-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Individuals who did not return a dosimeter and number of instances:</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="A62FDCAA" data-scroll-top="null" data-scroll-left="null" data-testid="output_5" style="width: 1012px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement eoOutputContent" data-width="982" data-height="73" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">             <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Name</strong>             <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Instances</strong>
    <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">______________________</strong>    <strong style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">_________</strong>

    {'Tom Marvolo Riddle'}       28    
    {'Luna Lovegood'     }       14    </div></div></div></div></div><h2  class = 'S5'><span>Appendix: functions used in the script</span></h2><div  class = 'S1'><span>Several custom functions are defined below that are used in the main body of the script.</span></div><div  class = 'S1'><span>The function </span><span style=' font-family: monospace;'>getCreateTable()</span><span> returns a character array that can be passed to SQLite to create an SQLite data table in the database.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">function </span><span >t = getCreateTable(name,fileFields,addFields,check)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% getCreatTable returns a character array that can be passed to SQLite to</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% define an SQL table in a database</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   t = getCreateTable(name,fileFields,addFields,check)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% where</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   name is the name of the SQL table</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   fieldFields is a cell array defining column names and SQLite types for</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     the data set</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   addFields is a cell array of any additional column names and SQLite</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     types</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   check is a character array defining an SQL data check statement</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   t is a character array returned by the function</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >   fieldDef = [fileFields addFields]; </span><span style="color: rgb(2, 128, 9);">% Combine the two cell arrays together</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >   prefix = [</span><span style="color: rgb(170, 4, 249);">'create table ' </span><span >name </span><span style="color: rgb(170, 4, 249);">' ('</span><span >]; </span><span style="color: rgb(2, 128, 9);">% Start of the SQL character array</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >   suffix = </span><span style="color: rgb(170, 4, 249);">')'</span><span >; </span><span style="color: rgb(2, 128, 9);">% End of the SQL character array</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >   n = numel(fieldDef);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">for </span><span >i=1:n </span><span style="color: rgb(2, 128, 9);">% Iterate through all the fields</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >       </span><span style="color: rgb(2, 128, 9);">% Add the info (name and type) for the field to the prefix variable</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >       prefix = strcat(prefix,[char(fieldDef{i}{1}) </span><span style="color: rgb(170, 4, 249);">' ' </span><span >char(fieldDef{i}{2}) </span><span style="color: rgb(170, 4, 249);">','</span><span >]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >   t = [prefix check suffix]; </span><span style="color: rgb(2, 128, 9);">% Add the check statement and closing suffix</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span>The function </span><span style=' font-family: monospace;'>getDataFromExcel()</span><span> reads the data from an Excel file (</span><span style=' font-family: monospace;'>file</span><span>) into MATLAB as a MATLAB table, with the field values as MATLAB strings and the field names overwritten by the specified file fields (</span><span style=' font-family: monospace;'>fileFields</span><span>). The function returns the MATLAB table.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">function </span><span >d = getDataFromExcel(file,fileFields)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% getDataFromExcel reads data from an Excel file and overwrites the field</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% names with user supplied values</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   d = getDataFromExcel(file,fileFields)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% where</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%  file is a row of a MATLAB table corresponding to the details of a file,</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%    as output by the dir() function</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%  fileFields is a cell array with the names and SQLite types the user</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%    wishes to use for the columns of the data (overwrites names in file)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    fullpath2file = fullfile(file.folder,file.name); </span><span style="color: rgb(2, 128, 9);">% Path to Excel file</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    opts = detectImportOptions(fullpath2file); </span><span style="color: rgb(2, 128, 9);">% Get import options</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">for </span><span >i=1:numel(opts.VariableTypes)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        opts.VariableTypes{i} = </span><span style="color: rgb(170, 4, 249);">'string'</span><span >; </span><span style="color: rgb(2, 128, 9);">% Set import all data as strings</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    opts.VariableNamingRule = </span><span style="color: rgb(170, 4, 249);">'preserve'</span><span >; </span><span style="color: rgb(2, 128, 9);">% Set to preserve column names </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    d = readtable(fullpath2file,opts); </span><span style="color: rgb(2, 128, 9);">% Read the data with the options</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    c={}; </span><span style="color: rgb(2, 128, 9);">% Create empty cell array    </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">for </span><span >i=1:numel(fileFields) </span><span style="color: rgb(2, 128, 9);">% Iterate through fields i.e. Excel columns</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        c{i}=fileFields{i}{1}; </span><span style="color: rgb(2, 128, 9);">% Add field name to cell array</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span><span >   </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    d.Properties.VariableNames = c; </span><span style="color: rgb(2, 128, 9);">% Overwite all field names</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span>The </span><span style=' font-family: monospace;'>getIsNew()</span><span> function checks whether the data we intend to write is already present in the database and returns a 0 if it is (or 1 if it's not). The function works by querying the entries in the database that have the relevant UID value (there shouldn't be any for a new dose report file). When the last input of the function is set to </span><span style=' font-family: monospace;'>safe=false</span><span>, a simple syntax is used to query the database. While simple, this approach is not secure as it allows something called "SQL Injection". A malicious party could alter a dose report and modify the Report UID value to include a string that changes the SQL command. For example, modifying the first row of the Report UID column in one of the Excel files from "1642" to "1642 OR ReportUID&gt;0" would guarantee that the function returns 0 i.e. it would not add the file's data to the database. This example is somewhat contrived and would entail that the villain has some knowledge of our MATLAB code. The malicious agent could also cause much more trouble by simply modifying the data in the files! However, it is good to know that SQL Injection exists and that there are good practices that can prevent it. If </span><span style=' font-family: monospace;'>safe=true</span><span>, a slightly more complicated (but safer) syntax is used that binds values (i.e., the values of the </span><span style=' font-family: monospace;'>uidName</span><span> and </span><span style=' font-family: monospace;'>uid</span><span> variables) to parameters (i.e., the "?" that appear in the prepared SQL query statement). This prevents SQL injection, as the "?" is interpreted as a parameter not simply part of an SQL query statement. Confused? See more online, for example: </span><a href = "https://en.wikipedia.org/wiki/SQL_injection."><span>https://en.wikipedia.org/wiki/SQL_injection.</span></a><span> Thanks go to Josef Lundman for highlighting this issue.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">function </span><span >i = getIsNew(doseData,conn,uidName,safe)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% getIsNew tests whether data is already saved in a database</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   i = getIsNew(doseData,conn,uidName,safe)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% where</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   doseData is a MATLAB table of data</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   conn is a connection to an SQLite database</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   uidName is a table field that contains a value unique to the data</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   safe is a logical parameter; if true, safer code is employed that</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     prevents SQL injection</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   i is the returned value (1 for new and 0 for already saved)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    uid = doseData.(uidName){1}; </span><span style="color: rgb(2, 128, 9);">% Only checks the first data row</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >~safe </span><span style="color: rgb(2, 128, 9);">% Allows SQL Injection</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        sqlQuery = [</span><span style="color: rgb(170, 4, 249);">'SELECT ' </span><span >uidName </span><span style="color: rgb(170, 4, 249);">' FROM doseTable WHERE ' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        uidName </span><span style="color: rgb(170, 4, 249);">'==' </span><span >uid] </span><span style="color: rgb(2, 128, 9);">% Define the SQL query</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        results = fetch(conn,sqlQuery) </span><span style="color: rgb(2, 128, 9);">% Get the results</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">else </span><span style="color: rgb(2, 128, 9);">% Prevents SQL Injection</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        selection = [1 2]; </span><span style="color: rgb(2, 128, 9);">% First and second question marks (parameters)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        values = {uidName, uid}; </span><span style="color: rgb(2, 128, 9);">% Values corresponding to the parameters</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        sqlQuery = [</span><span style="color: rgb(170, 4, 249);">'SELECT ? FROM doseTable WHERE ' </span><span >uidName </span><span style="color: rgb(170, 4, 249);">' == ?'</span><span >]; </span><span style="color: rgb(14, 0, 255);">...</span><span style="color: rgb(2, 128, 9);"> </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(2, 128, 9);">% Parameterize the SQL query</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        pstmt = databasePreparedStatement(conn,sqlQuery); </span><span style="color: rgb(2, 128, 9);">% Prepare statement</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        pstmt = bindParamValues(pstmt,selection,values); </span><span style="color: rgb(2, 128, 9);">% Bind values</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        results = fetch(conn,pstmt); </span><span style="color: rgb(2, 128, 9);">% Get the results</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        close(pstmt)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >numel(results) ~= 0 </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        i = 0; </span><span style="color: rgb(2, 128, 9);">% If results is not empty, assign 0 (not new)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        i = 1; </span><span style="color: rgb(2, 128, 9);">% If results is empty, assign 1 (new)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end </span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span>The </span><span style=' font-family: monospace;'>getRowData()</span><span> function takes the field names for an entry to the database (</span><span style=' font-family: monospace;'>fileFields</span><span>,</span><span style=' font-family: monospace;'> addFields</span><span>) and the dose report data from an Excel file (</span><span style=' font-family: monospace;'>doseData</span><span>) and formats the information in terms of row and column name data that can be passed to SQLite in an </span><span style=' font-family: monospace;'>insert()</span><span> statement.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">function </span><span >[r, c] = getRowData(fileFields,addFields,doseData)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% getRowData returns data for a row of the SQL table in a format that</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% can be written to an SQLite database. The column names are also returned.</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   [r, c] = getRowData(fileFields,addFields,doseData)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% where</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   fieldFields is a cell array with the field names and types</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     corresponding to the data from an Excel file</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   addFields is a cell array with any additional field names and types</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   doseData is a MATLAB table with the data from an Excel file</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   r is a cell array with row data for writing to an SQLite database</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%   c is a cell array with the column names corresponding to the rows</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    nel = numel(doseData);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    r = {}; </span><span style="color: rgb(2, 128, 9);">% Empty cell array to contain row data</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">for </span><span >k=1:nel </span><span style="color: rgb(2, 128, 9);">% Iterate through columns of the doseData MATLAB table</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        fieldname= fileFields{k}{1}; </span><span style="color: rgb(2, 128, 9);">% Field name for the field</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        typename = fileFields{k}{2}; </span><span style="color: rgb(2, 128, 9);">% SQLite type for the field</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        dataitem = doseData.(fieldname)(1); </span><span style="color: rgb(2, 128, 9);">% Data value (as MATLAB string)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">if </span><span >strcmp(typename,</span><span style="color: rgb(170, 4, 249);">'VARCHAR'</span><span >) </span><span style="color: rgb(2, 128, 9);">% If SQLite type is VARCHAR</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">if </span><span >dataitem==</span><span style="color: rgb(170, 4, 249);">"NR" </span><span style="color: rgb(2, 128, 9);">% If data value is "Not Returned"</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >                data = string(missing()); </span><span style="color: rgb(2, 128, 9);">% Define element as missing</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">else </span><span style="color: rgb(2, 128, 9);">% Otherwise</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >                data=string(dataitem); </span><span style="color: rgb(2, 128, 9);">% Define element as string</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">elseif </span><span >strcmp(typename,</span><span style="color: rgb(170, 4, 249);">'DATE'</span><span >) </span><span style="color: rgb(2, 128, 9);">% If SQLite type is DATE</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">if </span><span >dataitem==</span><span style="color: rgb(170, 4, 249);">"NR" </span><span style="color: rgb(2, 128, 9);">% If data value is "Not Returned"</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >                data = NaT; </span><span style="color: rgb(2, 128, 9);">% Define element as "Not a Datetime" (NaT)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">else </span><span style="color: rgb(2, 128, 9);">% Otherwise</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >                data=datetime(dataitem,</span><span style="color: rgb(170, 4, 249);">'InputFormat'</span><span >,</span><span style="color: rgb(170, 4, 249);">'dd-MMM-yyyy'</span><span >); </span><span style="color: rgb(2, 128, 9);">% To datetime</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">elseif </span><span >strcmp(typename,</span><span style="color: rgb(170, 4, 249);">'DOUBLE'</span><span >) </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >                | strcmp(typename,</span><span style="color: rgb(170, 4, 249);">'INTEGER'</span><span >) </span><span style="color: rgb(2, 128, 9);">% If SQLite type DOUBLE/INTEGER</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">if </span><span >dataitem == </span><span style="color: rgb(170, 4, 249);">"B" </span><span >| ismissing(dataitem) | dataitem==</span><span style="color: rgb(170, 4, 249);">"NR" </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >                    </span><span style="color: rgb(2, 128, 9);">% If "Below Threshold", missing or "Not returned"</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >                data = NaN; </span><span style="color: rgb(2, 128, 9);">% Set to Not a Number (NaN)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">else </span><span style="color: rgb(2, 128, 9);">% Otherwise</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >                data = str2num(replace(dataitem,</span><span style="color: rgb(170, 4, 249);">','</span><span >,</span><span style="color: rgb(170, 4, 249);">'.'</span><span >)); </span><span style="color: rgb(2, 128, 9);">% Convert to MATLAB double</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        r{k} = data; </span><span style="color: rgb(2, 128, 9);">% Append the data element to the row cell array</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% Append a final element to the cell array corresponding to the field in addFields</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% This field is "Status" and indicates whether the reading to below</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% threshold (B), not returned (NR) or valid (OK)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >doseData.(</span><span style="color: rgb(170, 4, 249);">'Hp10'</span><span >)(1) == </span><span style="color: rgb(170, 4, 249);">"B" </span><span >| doseData.(</span><span style="color: rgb(170, 4, 249);">'Hp007'</span><span >)(1) == </span><span style="color: rgb(170, 4, 249);">"B"</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        r{nel+1} = </span><span style="color: rgb(170, 4, 249);">"B"</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">elseif </span><span >doseData.(</span><span style="color: rgb(170, 4, 249);">'ReadDate'</span><span >)(1) == </span><span style="color: rgb(170, 4, 249);">"NR" </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        r{nel+1} = </span><span style="color: rgb(170, 4, 249);">"NR"</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        r{nel+1} = </span><span style="color: rgb(170, 4, 249);">"OK"</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    fieldDef = [fileFields addFields]; </span><span style="color: rgb(2, 128, 9);">% Cell array of all fields</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    c={}; </span><span style="color: rgb(2, 128, 9);">% Empty cell array to contain column names (fields)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">for </span><span >i=1:numel(fieldDef) </span><span style="color: rgb(2, 128, 9);">% Iterate through fields</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        c{i}=fieldDef{i}{1}; </span><span style="color: rgb(2, 128, 9);">% Append field name to column cell array</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% A script demonstrating how to work with databases in MATLAB 
% This MATLAB Live Script (mlx-file) accompanies the article "Hacking Medical 
% Physics. Part 2. Working with databasesâ€”a step beyond spreadsheets" published 
% in the Spring 2022 issue of _European Medical Physics News_. The script illustrates 
% how to:
%% 
% * Connect to an SQLite database in MATLAB using the JDBC drivers (the driver 
% is in the _lib-matlab_ subdirectory of this repository, i.e. _EMP-News/Part2/lib-matlab_)
% * How to read Excel file data with a fictionalized style of staff dose report 
% into MATLAB.
% * How to write the staff dose data to an SQLite database
% * How to query the database
% * And how to process and plot the query results in boxplots 
%% 
% Requirements: this script requires that the _Database Toolbox_ of MATLAB is 
% installed, along with the _Statistics and Machine Learning Toolbox_ (the latter 
% only for creating the boxplots).
% 
% We will clear the MATLAB workspace before beginning.

clear
%% 1. Define SQLite data fields and checks
% We start by defining three MATLAB variables: |fileFields|, |addFields| and 
% |check|.
% 
% |fileFields|: this is a cell array, with each element corresponding to a column 
% of the dose report (i.e., Excel) files we intend to read. Each cell element 
% itself consists or two character arrays: the name of the data column and the 
% type it will be saved as in the SQLite database. Note that the column name need 
% not match the name in the Excel file, although the order in the cell array matches 
% the column order in the Excel file.
% 
% |addFields|: this is a cell array listing any additional fields that we wish 
% to save to the SQLite database. In this case, it will be only one field: a status 
% variable indicating whether a dose reading was valid ('OK'), below threshold 
% ('B') or not returned ('NR').
% 
% |check|: this is a character array defining a check statement to be passed 
% to SQLite. When part of the definition of an SQLite data table, it enforces 
% the listed conditions when data entries are added to the database, i.e., an 
% error is thrown by SQLite if the conditions are not met. 

fileFields = { {'Customer', 'VARCHAR'}, {'CustomerUID', 'INTEGER'}, ...
     {'Department', 'VARCHAR'}, {'DepartmentUID', 'INTEGER'}, ...
     {'Name', 'VARCHAR'}, {'PersonUID', 'INTEGER'}, ...
     {'RadiationType', 'VARCHAR'}, {'Hp10', 'DOUBLE'}, ...
     {'Hp007', 'DOUBLE'}, ...
     {'UserType', 'VARCHAR'}, {'DosimeterType', 'VARCHAR'}, ...
     {'DosimeterPlacement', 'VARCHAR'}, {'DosimeterUID', 'INTEGER'}, ...
     {'StartDate', 'DATE'}, {'EndDate', 'DATE'}, ...
     {'ReadDate', 'DATE'}, {'ReportDate', 'DATE'}, ...
     {'ReportUID', 'INTEGER'}};

addFields = {{'Status', 'VARCHAR'}};

check = ['CHECK( (Status IN (''NR'',''B'') AND ' ...
    '(Hp10 IS NULL AND Hp007 IS NULL)) OR ' ...
    '(Status IN (''OK'') AND '...
    '(Hp10 IS NOT NULL OR Hp007 IS NOT NULL))) '];
%% 
% _*An aside on character arrays and strings (not essential, but may be helpful)*_
% 
% The differences between _character arrays_ and _string arrays_ can be slightly 
% confusing in MATLAB. Check the MATLAB Help for more information. It's worth 
% noting, however, that in MATLAB character arrays are defined between single 
% quotes, whereas strings are defined between double quotes. To include a single 
% quote character within a character array, one simply writes two single quotes 
% together. Thus, the check statement above will actually display as:
% 
% check =
% 
% 'CHECK( (Status IN ('NR','B') AND (Hp10 IS NULL AND Hp007 IS NULL)) OR (Status 
% IN ('OK') AND (Hp10 IS NOT NULL OR Hp007 IS NOT NULL))) '
% 
% In this script, some text sequences are stored in variables as strings and 
% others as character arrays. We have tried to be consistent to the extent that 
% all explicitly written (hard-coded) text sequences are written as character 
% arrays. When working with string variables, we some sometimes rely on implicit 
% conversion of character arrays to strings. For example, in Section 5 we pass 
% character arrays to the |contains()| function as the substrings for matching. 
% MATLAB is clever enough to interpret our inputs correctly. It's important to 
% remember, however, that some statements that you can execute with strings are 
% invalid with character arrays and _vice versa_. After all, there are reasons 
% why both data types exist!
%% 2. Setup and configure SQLite database (if it doesn't exist)
% First, we define a path name for the directory for our database file to be 
% placed in. The directory is to be called 'db-matlab' and will be placed in a 
% present working directory (which is returned by the |pwd| function). If the 
% database directory dosesn't already exist then it is made using the make directory 
% function, |mkdir()|. Note that |fullfile()| function adds the directory name 
% ('db-matlab') to the path (|pwd|) with the appropriate slash separator inserted 
% between them. The full path to the database file is then generated and assigned 
% to the variable |dbFile|, again using |fullfile()| function.

databasePath = fullfile(pwd,'db-matlab');

if ~exist(databasePath, 'dir')
    mkdir(databasePath);
end

dbFile = fullfile(databasePath,'dose-matlab.db');
%% 
% Now we check if our database source exists (it won't unless you've run this 
% script previously). The |listDataSources()| function returns a MATLAB table 
% with details of data sources. The next line checks whether the 'Name' column 
% in the table has any entries equal to |ourSource| (i.e.,  "SQLiteEMP"). If so, 
% the |createDataSource| variable takes the value |false|, otherwise it takes 
% the value |true|. If |true|, the if-statement is executed and the datasource 
% SQLiteEMP is created, with the path to the JDBC driver file specified. Note 
% that the database file name associated with this source is defined to be 'dose-matlab.db' 
% and its location defined as the directory created earlier (i.e., |databasePath|).

ourSource = 'SQLiteEMP';
dataSources = listDataSources();
createDataSource = (sum(dataSources.('Name') == ourSource) == 0);

if createDataSource
    vendor = 'Other';
    opts = databaseConnectionOptions('jdbc',vendor);
    opts = setoptions(opts, ...
    'DataSourceName',ourSource, ...
    'JDBCDriverLocation','lib-matlab/sqlite-jdbc-3.36.0.3.jar', ...
    'Driver','org.sqlite.JDBC', ...  
    'URL',strcat('jdbc:sqlite:',dbFile));
    saveAsDataSource(opts);
end
%% 
% We've made sure that the directory to hold the database exists and that an 
% appropriate database source is configured in MATLAB. Now, if the database file 
% itself doesn't exist (which it won't if you have never run this script), it 
% will be created. This is done by connecting to the data source using the |database()| 
% function. An SQL data table called 'doseTable' is also added to the SQLite database 
% using the |execute()| function. The character array |createTable| is passed 
% to |execute()|, defining the data columns and types of the SQLite table, as 
% well as the data checks. Refer to the |getCreateTable()| function at the bottom 
% of the script to see how we generate the character array. The connection to 
% the database is closed using the the |close()| function.

if ~isfile(dbFile)
    conn = database(ourSource,'',''); % Connect to the database
    createTable = getCreateTable('doseTable',fileFields,addFields,check); % Define and sql statement to create table
    execute(conn,createTable)  % Create the sql table in the database
    close(conn); % Close the database connection
end
%% 3. Read data from Excel files and write to the database
% We provide a pop-up window to the user to specifiy the location of the Excel 
% files. This is done using the |uigetdir()| function. The user should select 
% the _reports_ directory when running the example, as we have populated this 
% with example files. The |dir()| function is then used to return a table of file 
% details for all files in the directory that have the file suffix 'xls'.

newDataLocation = uigetdir(pwd,'Select a directory with dose reports');

files = dir(fullfile(newDataLocation,'*xls'));
%% 
% A connection to the data source is opened and then the set of Excel files 
% are iterated through. See the function |getDataFromExcel()| at the bottom of 
% this script to see how we extract the data from the Excel files. Before writing 
% to the database, a check is performed to see if the data has previously been 
% written to the database. This is achived using the |getIsNew()| function (again 
% see the bottom of the script for the function definition), which checks to see 
% whether the value of the 'ReportUID' field already exists in the database. If 
% the data does already existsin the database, the file is skipped by using a 
% |continue| statement, which jumps to the next value of the incrementer in the 
% for-loop. If the data is new, the rows of the Excel files (dosimeter readings) 
% are iterated through, with each row being written to the database table using 
% the |insert()| function. The |getRowData()| function (see end of script) formats 
% the row data and column names in a format appropriate for the interface to SQLite. 
% When all the data has been written, the database connection is closed.

conn = database(ourSource,'','');

nf = numel(files);
for i=1:nf % Iterate through the Excel files
    fpop = msgbox(['Processing file ' num2str(i) ' of ' num2str(nf)],'modal'); % Pop-up to indicate progress
    doseData = getDataFromExcel(files(i),fileFields);  % See functions at end of script
    isNew = getIsNew(doseData,conn,'ReportUID',true); % See functions at end of script
    if ~isNew
        disp('Ignoring a file based on non-unique ReportNr')
        disp([files(i).name ' is already in the database']);
        continue
    end    
    nl = size(doseData,1);
    for j=1:nl % Iterate through rows of an Excel file (dosimeter readings)
        [rowData, colNames] = getRowData(fileFields,addFields,doseData(j,:)); % See functions at end of script
        insert(conn,'doseTable',colNames,rowData) % Insert data into the database
    end
end

if ishandle(fpop)
    close(fpop)
end

close(conn);
%% 4. Querying the database
% In practice, queries would likely be performed in the MATLAB command window, 
% or a separate script (or even using MATLAB's Database Explorer app). For illustrative 
% purposes, however, we provide examples of querying (and plotting) here. The 
% steps are:
%% 
% # Connect to the database (using |database()|)
% # Construct a query statement (a character array)
% # Request the query results (using f|etch()|)
% # Close the connection (using |close()|)
%% 
% We construct a query requesting the _PersonUID_, _Department_, _Hp10_ values 
% and measurement period _EndDate_ from the _doseTable_ table of the SQLite database, 
% for data entries where the dosimeter is of type 'Badge' and the reading status 
% is valid (i.e., 'OK'). The data extracted is also ordered by increasing value 
% of _EndDate_, using the "ORDER BY" clause of SQLite. The data is returned as 
% a MATLAB table with the variable name of |results|. 

conn = database('SQLiteEMP','','');

sqlQuery = ['SELECT PersonUID, Department, Hp10, EndDate FROM doseTable ' ...
    'WHERE DosimeterType = ''Badge'' AND Status IN (''OK'') ' ...
    'ORDER BY EndDate'];

results = fetch(conn,sqlQuery);

close(conn);
%% 
% Note that we have not included dosimeter results below minimum threshold in 
% the returned results (i.e., Status = 'B'). Although a user might wish to include 
% these cases in practice, a decision on the numerical value of dose to assign 
% to them would have to be made.  
%% 5. Processing the results and plotting the data
% Now we will filter the results and plot them in boxplots, breaking the Hp(10) 
% dose readings down by department and year. A straightforward way to do this 
% is to create masks (arrays of |true| and |false| values) that select the year 
% or department. This is done below. The |contains()| function is useful for testing 
% whether a substring is present within a string (or within each string of a string 
% array, as we do here).

EndDates = string(results.EndDate);
mask2020 = contains(EndDates,'2020');
mask2021 = contains(EndDates,'2021');

Departments = string(results.Department);
maskNM=contains(Departments,'Nuclear Medicine');
maskDR=contains(Departments,'Diagnostic Radiology');
maskRT=contains(Departments,'Radiotherapy');
%% 
% Now we generate a figure and create the first subplot, corresponding to the 
% Nuclear Medicine department and the years 2020 and 2021. The year and department 
% masks are used to filter the results. The |boxplot()| function of MATLAB is 
% then used to display the data,. The |ylim()| (the y-axis extent), |ylabel()| 
% (the label for the y-axis) and |xlabel| (the label for the x-axis) functions 
% are used to format the plot.

figure

subplot(1,3,1) % Nuclear Medicine subplot

doses2020 = results(mask2020 & maskNM,:).('Hp10');
num2020 = numel(doses2020);
years2020 = strings(num2020,1);
years2020(1:num2020) = '2020';

doses2021 = results(mask2021 & maskNM,:).('Hp10');
num2021 = numel(doses2021);
years2021 = strings(num2021,1);
years2021(1:num2021) = '2021';

boxplot([doses2020;doses2021],[years2020;years2021],'symbol','r.', 'OutlierSize',10)
ylim([0.04,0.205])
ylabel('Hp(10)')
xlabel('Nuclear Medicine')
%% 
% We then repeat the same process for the Diagnostic Radiology and Radiotherapy 
% departments.

subplot(1,3,2) % Diagnostic Radiology subplot

doses2020 = results(mask2020 & maskDR,:).('Hp10');
num2020 = numel(doses2020);
years2020 = strings(num2020,1);
years2020(1:num2020) = '2020';

doses2021 = results(mask2021 & maskDR,:).('Hp10');
num2021 = numel(doses2021);
years2021 = strings(num2021,1);
years2021(1:num2021) = '2021';

boxplot([doses2020;doses2021],[years2020;years2021],'symbol','r.', 'OutlierSize',10)
ylim([0.04,0.205])
xlabel('Diagnostic Radiology')

subplot(1,3,3) % Radiotherapy subplot

doses2020 = results(mask2020 & maskRT,:).('Hp10');
num2020 = numel(doses2020);
years2020 = strings(num2020,1);
years2020(1:num2020) = '2020';

doses2021 = results(mask2021 & maskRT,:).('Hp10');
num2021 = numel(doses2021);
years2021 = strings(num2021,1);
years2021(1:num2021) = '2021';

boxplot([doses2020;doses2021],[years2020;years2021],'symbol','r.', 'OutlierSize',10)
ylim([0.04,0.205])
xlabel('Radiotherapy')
%% 6. Bonus queries
% We have our boxplot and are finished. This gives just a taste of what is possible 
% when working with databases. For fun, we have included a few more example queries 
% below.

conn = database('SQLiteEMP','','');

% The ORDER BY clause in SQL is useful for ordering data
% Ordering can be ascending (ASC) or descending (DESC)
sqlQuery = ['SELECT StartDate, EndDate FROM doseTable ' ...
    'WHERE Status != ''NR'' ORDER BY StartDate ASC'];

results = fetch(conn,sqlQuery);

close(conn);

formatSpec = 'Earliest and latest records of staff dose readings are %s and %s';
R1 = string(results{1,1});
R2 = string(results{end,1});
% fprintf() is useful for inserting variable values into a string before
%   printing the string to the MATLAB screen
fprintf(formatSpec,R1,R2)
conn = database('SQLiteEMP','','');

% The COUNT function in SQL allow you to sum cases
% The AS clause in SQL allows you to designate a column name for the output of a function
% The GROUP BY clause allows you to break down the results by a variable
sqlQuery = ['SELECT COUNT(Hp10) AS Nr_Hp10, COUNT(Hp007) AS Nr_Hp007, DosimeterType ' ...
    'FROM doseTable WHERE Status != ''NR'' GROUP BY DosimeterType'];

results = fetch(conn,sqlQuery);

close(conn);

fprintf('Number of staff dose readings, per dosimeter type:\n\n'), ...
    disp(results) % Note: disp() allows you to print a non-text variable to screen 
conn = database('SQLiteEMP','','');

sqlQuery = ['SELECT Name, COUNT(Status == "NR") AS Instances FROM doseTable ' ...
    'WHERE Status == ''NR'' GROUP BY NAME ORDER BY COUNT(Status = ''NR'') DESC'];

results = fetch(conn,sqlQuery);

close(conn);

fprintf('Individuals who did not return a dosimeter and number of instances:\n\n'), ...
    disp(results)
%% Appendix: functions used in the script
% Several custom functions are defined below that are used in the main body 
% of the script.
% 
% The function |getCreateTable()| returns a character array that can be passed 
% to SQLite to create an SQLite data table in the database.

function t = getCreateTable(name,fileFields,addFields,check)
% getCreatTable returns a character array that can be passed to SQLite to
% define an SQL table in a database
%   t = getCreateTable(name,fileFields,addFields,check)
% where
%   name is the name of the SQL table
%   fieldFields is a cell array defining column names and SQLite types for
%     the data set
%   addFields is a cell array of any additional column names and SQLite
%     types
%   check is a character array defining an SQL data check statement
%   t is a character array returned by the function
%
   fieldDef = [fileFields addFields]; % Combine the two cell arrays together
   prefix = ['create table ' name ' (']; % Start of the SQL character array
   suffix = ')'; % End of the SQL character array
   n = numel(fieldDef);
   for i=1:n % Iterate through all the fields
       % Add the info (name and type) for the field to the prefix variable
       prefix = strcat(prefix,[char(fieldDef{i}{1}) ' ' char(fieldDef{i}{2}) ',']);
   end
   t = [prefix check suffix]; % Add the check statement and closing suffix
end
%% 
% The function |getDataFromExcel()| reads the data from an Excel file (|file|) 
% into MATLAB as a MATLAB table, with the field values as MATLAB strings and the 
% field names overwritten by the specified file fields (|fileFields|). The function 
% returns the MATLAB table.

function d = getDataFromExcel(file,fileFields)
% getDataFromExcel reads data from an Excel file and overwrites the field
% names with user supplied values
%   d = getDataFromExcel(file,fileFields)
% where
%  file is a row of a MATLAB table corresponding to the details of a file,
%    as output by the dir() function
%  fileFields is a cell array with the names and SQLite types the user
%    wishes to use for the columns of the data (overwrites names in file)
%
    fullpath2file = fullfile(file.folder,file.name); % Path to Excel file
    opts = detectImportOptions(fullpath2file); % Get import options
    for i=1:numel(opts.VariableTypes)
        opts.VariableTypes{i} = 'string'; % Set import all data as strings
    end
    opts.VariableNamingRule = 'preserve'; % Set to preserve column names 
    d = readtable(fullpath2file,opts); % Read the data with the options
    c={}; % Create empty cell array    
    for i=1:numel(fileFields) % Iterate through fields i.e. Excel columns
        c{i}=fileFields{i}{1}; % Add field name to cell array
    end   
    d.Properties.VariableNames = c; % Overwite all field names
end
%% 
% The |getIsNew()| function checks whether the data we intend to write is already 
% present in the database and returns a 0 if it is (or 1 if it's not). The function 
% works by querying the entries in the database that have the relevant UID value 
% (there shouldn't be any for a new dose report file). When the last input of 
% the function is set to |safe=false|, a simple syntax is used to query the database. 
% While simple, this approach is not secure as it allows something called "SQL 
% Injection". A malicious party could alter a dose report and modify the Report 
% UID value to include a string that changes the SQL command. For example, modifying 
% the first row of the Report UID column in one of the Excel files from "1642" 
% to "1642 OR ReportUID>0" would guarantee that the function returns 0 i.e. it 
% would not add the file's data to the database. This example is somewhat contrived 
% and would entail that the villain has some knowledge of our MATLAB code. The 
% malicious agent could also cause much more trouble by simply modifying the data 
% in the files! However, it is good to know that SQL Injection exists and that 
% there are good practices that can prevent it. If |safe=true|, a slightly more 
% complicated (but safer) syntax is used that binds values (i.e., the values of 
% the |uidName| and |uid| variables) to parameters (i.e., the "?" that appear 
% in the prepared SQL query statement). This prevents SQL injection, as the "?" 
% is interpreted as a parameter not simply part of an SQL query statement. Confused? 
% See more online, for example: <https://en.wikipedia.org/wiki/SQL_injection. 
% https://en.wikipedia.org/wiki/SQL_injection.> Thanks go to Josef Lundman for 
% highlighting this issue.

function i = getIsNew(doseData,conn,uidName,safe)
% getIsNew tests whether data is already saved in a database
%   i = getIsNew(doseData,conn,uidName,safe)
% where
%   doseData is a MATLAB table of data
%   conn is a connection to an SQLite database
%   uidName is a table field that contains a value unique to the data
%   safe is a logical parameter; if true, safer code is employed that
%     prevents SQL injection
%   i is the returned value (1 for new and 0 for already saved)
%
    uid = doseData.(uidName){1}; % Only checks the first data row
    if ~safe % Allows SQL Injection
        sqlQuery = ['SELECT ' uidName ' FROM doseTable WHERE ' ...
        uidName '==' uid] % Define the SQL query
        results = fetch(conn,sqlQuery) % Get the results
    else % Prevents SQL Injection
        selection = [1 2]; % First and second question marks (parameters)
        values = {uidName, uid}; % Values corresponding to the parameters
        sqlQuery = ['SELECT ? FROM doseTable WHERE ' uidName ' == ?']; ... 
            % Parameterize the SQL query
        pstmt = databasePreparedStatement(conn,sqlQuery); % Prepare statement
        pstmt = bindParamValues(pstmt,selection,values); % Bind values
        results = fetch(conn,pstmt); % Get the results
        close(pstmt)
    end
    if numel(results) ~= 0 
        i = 0; % If results is not empty, assign 0 (not new)
    else
        i = 1; % If results is empty, assign 1 (new)
    end 
end
%% 
% The |getRowData()| function takes the field names for an entry to the database 
% (|fileFields|, |addFields|) and the dose report data from an Excel file (|doseData|) 
% and formats the information in terms of row and column name data that can be 
% passed to SQLite in an |insert()| statement.

function [r, c] = getRowData(fileFields,addFields,doseData)
% getRowData returns data for a row of the SQL table in a format that
% can be written to an SQLite database. The column names are also returned.
%   [r, c] = getRowData(fileFields,addFields,doseData)
% where
%   fieldFields is a cell array with the field names and types
%     corresponding to the data from an Excel file
%   addFields is a cell array with any additional field names and types
%   doseData is a MATLAB table with the data from an Excel file
%   r is a cell array with row data for writing to an SQLite database
%   c is a cell array with the column names corresponding to the rows
%
    nel = numel(doseData);
    r = {}; % Empty cell array to contain row data
    for k=1:nel % Iterate through columns of the doseData MATLAB table
        fieldname= fileFields{k}{1}; % Field name for the field
        typename = fileFields{k}{2}; % SQLite type for the field
        dataitem = doseData.(fieldname)(1); % Data value (as MATLAB string)
        if strcmp(typename,'VARCHAR') % If SQLite type is VARCHAR
            if dataitem=="NR" % If data value is "Not Returned"
                data = string(missing()); % Define element as missing
            else % Otherwise
                data=string(dataitem); % Define element as string
            end
        elseif strcmp(typename,'DATE') % If SQLite type is DATE
            if dataitem=="NR" % If data value is "Not Returned"
                data = NaT; % Define element as "Not a Datetime" (NaT)
            else % Otherwise
                data=datetime(dataitem,'InputFormat','dd-MMM-yyyy'); % To datetime
            end
        elseif strcmp(typename,'DOUBLE') ...
                | strcmp(typename,'INTEGER') % If SQLite type DOUBLE/INTEGER
            if dataitem == "B" | ismissing(dataitem) | dataitem=="NR" ...
                    % If "Below Threshold", missing or "Not returned"
                data = NaN; % Set to Not a Number (NaN)
            else % Otherwise
                data = str2num(replace(dataitem,',','.')); % Convert to MATLAB double
            end
        end
        r{k} = data; % Append the data element to the row cell array
    end
    % Append a final element to the cell array corresponding to the field in addFields
    % This field is "Status" and indicates whether the reading to below
    % threshold (B), not returned (NR) or valid (OK)
    if doseData.('Hp10')(1) == "B" | doseData.('Hp007')(1) == "B"
        r{nel+1} = "B";
    elseif doseData.('ReadDate')(1) == "NR" 
        r{nel+1} = "NR";
    else
        r{nel+1} = "OK";
    end
    fieldDef = [fileFields addFields]; % Cell array of all fields
    c={}; % Empty cell array to contain column names (fields)
    for i=1:numel(fieldDef) % Iterate through fields
        c{i}=fieldDef{i}{1}; % Append field name to column cell array
    end
end
##### SOURCE END #####
-->
</div></body></html>